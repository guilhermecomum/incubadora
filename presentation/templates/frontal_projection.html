{% extends "base.html" %}
{% load i18n %}

{% block head %}
<script type="text/javascript">

$(document).ready(function() {
    var url = '{{ spectacle.get_commands_url }}';
    $('#command-list').html('');
    $.get( url, function ( data ) {
        if (!data.error) {
            $.each(data.commands, function(i, item) {
                $('<li id="command-'+item.pk+'"><span>'+item.name+'</span> : <span id="command-count-'+item.pk+'">'+item.total+'</span></li>').appendTo('#command-list');
            });
        }
    });
});

var happiness_meter_refresh = setInterval(
    function (){
        var url = '{{ spectacle.get_happiness_meter_url }}';
        $.get( url, function( data ) {
           if (!data.error) {
               $('#happiness-meter').html(data.value);
           }
        });
    },
    10000); // 10s

var commands_refresh = setInterval(
    function (){
        var url = '{{ spectacle.get_commands_url }}';
        $.get( url, function ( data ) {
            if (!data.error) {
                $.each(data.commands, function(i, item) {
                    if ($('#command-count-'+item.pk).length > 0) {
                        $('#command-count-'+item.pk).html(item.total);
                    } else {
                        $('<li id="command-'+item.pk+'"><span>'+item.name+'</span> : <span id="command-count-'+item.pk+'">'+item.total+'</span></li>').appendTo('#command-list');
                    }
                });
            }
        });
    },
    10000); // 10s

var mobile_interaction_refresh = setInterval(
    function (){
        var url = '{{ spectacle.get_mobile_interaction_url }}';
        $.get( url, function( data ) {
            if (!data.error) {
                // FIXME
                $('#mobile-interaction').html(data.mobile_interaction.toString());
            }
        });
    },
    10000); // 10s


</script>
{% endblock %}

{% block content %}

<div class="column grid_12">
    <span> Interação com celular:</span> <span id="mobile-interaction">{{ spectacle.mobile_interaction }}</span>
</div>

<div class="column grid_6">
    <ul id="command-list">
    </ul>
</div>

<div class="column grid_4">
    <span>Happiness Meter:</span> <span id="happiness-meter">{% if spectacle.mode == '1' %} {{ spectacle.easy_happiness_meter }}  {% else %} {{ spectacle.hard_happiness_meter }} {% endif %}</span>
</div>

{% endblock %}
