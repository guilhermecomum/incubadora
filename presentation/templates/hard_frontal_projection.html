{% extends "base.html" %}
{% load i18n %}

{% block head %}
<script type="text/javascript">

$(document).ready(function() {
    var url = '{{ spectacle.get_frontal_projection_commands_url }}';
    $('#command-list').html('');
    $.get( url, function ( data ) {
        if (!data.error) {
            $.each(data.commands, function(i, item) {
                $('<li id="command-'+item.pk+'"><span>'+item.name+'</span> : <span id="command-count-'+item.pk+'">'+item.total+'</span></li>').appendTo('#command-list');
            });
        }
    });
});

var happiness_meter_refresh = setInterval(
    function (){
        var url = '{{ spectacle.get_happiness_meter_url }}';
        $.get( url, function( data ) {
           if (!data.error) {
               $('#happiness-meter').html(data.value);
           }
        });
    },
    10000); // 10s

// FIXME
var commands_refresh = setInterval(
    function (){
        var url = '{{ spectacle.get_frontal_projection_commands_url }}';
        $.get( url, function ( data ) {
            if (!data.error) {
                $.each(data.commands, function(i, item) {
                    $('#command-count-'+item.pk).html(item.total);
                });
            }
        });
    },
    10000); // 10s

</script>
{% endblock %}

{% block content %}

<div class="column grid_12">
    <span> Interação com celular: {{ spectacle.mobile_interaction }}</span>
</div>

<div class="column grid_6">
    <ul id="command-list">
    </ul>
</div>

<div class="column grid_4">
    <span>Happiness Meter:</span> <span id="happiness-meter">{{ spectacle.hard_happiness_meter }}</span>
</div>

{% endblock %}
